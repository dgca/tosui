---
phase: 03-selection-controls
plan: 04
type: execute
subsystem: ui
---

<objective>
Create FormField wrapper component for form control composition.

Purpose: Provide a consistent layout wrapper that combines label, form control, helper text, and error message.
Output: FormField component exported from @tosui/react.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-phase.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-selection-controls/03-03-SUMMARY.md

**Key files:**
@packages/react/src/components/Label/Label.tsx
@packages/react/src/components/Input/Input.tsx
@packages/react/src/components/Box/Box.tsx

**Established patterns:**
- Label defaults to display=inline-block with mb=1
- Required asterisk uses aria-hidden
- Text component for typography
- VStack for vertical layout with gap

**Constraining decisions:**
- Composition over configuration: children are the form control
- Label component should be reused internally
- Error state should propagate to children via context or cloneElement
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create FormField component</name>
  <files>packages/react/src/components/FormField/FormField.tsx, packages/react/src/components/FormField/index.tsx</files>
  <action>
Create FormField component:
- Props:
  - label: string (required label text)
  - helperText?: string (optional description below control)
  - errorMessage?: string (shown when isInvalid, replaces helperText)
  - isRequired?: boolean (shows asterisk on label)
  - isInvalid?: boolean (shows error styling)
  - isDisabled?: boolean (passes to child)
  - children: ReactNode (the form control)
  - id?: string (used for label htmlFor and aria-describedby)
- Layout:
  - VStack with gap=1 for tight spacing
  - Label at top (using Label component)
  - Children (form control) in middle
  - Helper text or error message at bottom
- ID handling:
  - Generate ID if not provided using useId()
  - Pass id to label htmlFor
  - Add aria-describedby to children referencing helper/error text
- Error state:
  - Show errorMessage instead of helperText when isInvalid
  - Error text uses color="error-default"
  - Helper text uses color="foreground-muted" with fontSize="sm"
- Use React.cloneElement to pass isInvalid and isDisabled to children
- Create index.tsx barrel export
  </action>
  <verify>pnpm f:lib typecheck && pnpm f:lib build</verify>
  <done>FormField component created with label, helper text, error message, state propagation</done>
</task>

<task type="auto">
  <name>Task 2: Export FormField from library</name>
  <files>packages/react/src/index.tsx</files>
  <action>
Add FormField export to main library entry:
- Export FormField component
- Export FormFieldProps type
  </action>
  <verify>pnpm f:lib build && grep -q "FormField" packages/react/dist/index.d.ts</verify>
  <done>FormField exported from @tosui/react, visible in TypeScript declarations</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `pnpm f:lib typecheck` passes
- [ ] `pnpm f:lib build` succeeds
- [ ] FormField renders label, control, helper text correctly
- [ ] Error message appears and replaces helper text when isInvalid
- [ ] isInvalid/isDisabled props propagate to child controls
- [ ] aria-describedby links control to helper/error text
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No TypeScript errors
- State propagation to children works
- Accessibility attributes properly connected
</success_criteria>

<output>
After completion, create `.planning/phases/03-selection-controls/03-04-SUMMARY.md`
</output>
