# Plan: Accordion + App.tsx Examples

## Objective

Create Accordion and AccordionItem components for collapsible sections, then add all Phase 7 examples to App.tsx.

## Tasks

### Task 1: Create Accordion Component

Create `packages/react/src/components/Accordion/`:

**Accordion.tsx:**
```tsx
import { type ReactNode, createContext, useContext, useState } from "react";
import clsx from "clsx";
import { Box } from "@/components/Box/Box";
import styles from "./accordion.module.css";

// Context
type AccordionContextValue = {
  expandedIndex: number | number[] | null;
  toggleIndex: (index: number) => void;
  allowMultiple: boolean;
};

const AccordionContext = createContext<AccordionContextValue | null>(null);

function useAccordionContext() {
  const context = useContext(AccordionContext);
  if (!context) throw new Error("AccordionItem must be used within Accordion");
  return context;
}

// Types
export type AccordionProps = {
  /** Default expanded index(es) */
  defaultIndex?: number | number[];
  /** Allow multiple items expanded */
  allowMultiple?: boolean;
  /** Additional class name */
  className?: string;
  /** Accordion items */
  children?: ReactNode;
};

export type AccordionItemProps = {
  /** Item index (set manually) */
  index: number;
  /** Item title */
  title: ReactNode;
  /** Whether disabled */
  isDisabled?: boolean;
  /** Additional class name */
  className?: string;
  /** Item content */
  children?: ReactNode;
};

export function Accordion({
  defaultIndex,
  allowMultiple = false,
  className,
  children,
}: AccordionProps) {
  const [expandedIndex, setExpandedIndex] = useState<number | number[] | null>(
    defaultIndex ?? (allowMultiple ? [] : null)
  );

  const toggleIndex = (index: number) => {
    if (allowMultiple) {
      const current = (expandedIndex as number[]) || [];
      const newExpanded = current.includes(index)
        ? current.filter((i) => i !== index)
        : [...current, index];
      setExpandedIndex(newExpanded);
    } else {
      setExpandedIndex(expandedIndex === index ? null : index);
    }
  };

  return (
    <AccordionContext.Provider value={{ expandedIndex, toggleIndex, allowMultiple }}>
      <Box
        border="thin"
        borderColor="border"
        rounded="md"
        overflow="hidden"
        className={clsx(styles.accordion, className)}
      >
        {children}
      </Box>
    </AccordionContext.Provider>
  );
}

export function AccordionItem({
  index,
  title,
  isDisabled = false,
  className,
  children,
}: AccordionItemProps) {
  const { expandedIndex, toggleIndex, allowMultiple } = useAccordionContext();

  const isExpanded = allowMultiple
    ? ((expandedIndex as number[]) || []).includes(index)
    : expandedIndex === index;

  return (
    <Box
      className={clsx(
        styles.item,
        isExpanded && styles.expanded,
        isDisabled && styles.disabled,
        className
      )}
    >
      <Box
        as="button"
        type="button"
        display="flex"
        alignItems="center"
        justifyContent="space-between"
        w="100%"
        p={4}
        bg="transparent"
        border="none"
        borderBottom={isExpanded ? "thin" : "none"}
        borderColor="border"
        cursor={isDisabled ? "not-allowed" : "pointer"}
        opacity={isDisabled ? "faint" : undefined}
        onClick={() => !isDisabled && toggleIndex(index)}
        aria-expanded={isExpanded}
        aria-disabled={isDisabled}
        className={styles.button}
      >
        <Box fontWeight="medium">{title}</Box>
        <Box
          as="span"
          className={clsx(styles.icon, isExpanded && styles.rotated)}
        >
          â–¾
        </Box>
      </Box>
      {isExpanded && (
        <Box p={4} className={styles.content}>
          {children}
        </Box>
      )}
    </Box>
  );
}
```

**accordion.module.css:**
```css
.accordion {
  /* Container */
}

.item {
  border-bottom: 1px solid var(--t-color-border);
}

.item:last-child {
  border-bottom: none;
}

.button {
  transition: background-color 0.15s ease;
  text-align: left;
}

.button:hover:not(:disabled) {
  background-color: var(--t-color-surface-hover, rgba(0, 0, 0, 0.02));
}

.icon {
  transition: transform 0.2s ease;
}

.rotated {
  transform: rotate(180deg);
}

.content {
  /* Content panel */
}

.disabled {
  opacity: 0.5;
}
```

**index.tsx:**
```tsx
export { Accordion, AccordionItem } from "./Accordion";
export type { AccordionProps, AccordionItemProps } from "./Accordion";
```

### Task 2: Export Accordion and Add App.tsx Examples

1. Add Accordion exports to `packages/react/src/index.tsx`
2. Add all Phase 7 component examples to App.tsx:

**Modal examples:**
- Basic modal with header/body/footer
- Different sizes

**Tooltip examples:**
- Different placements
- With delay

**Popover examples:**
- Basic popover
- With header/body

**Accordion examples:**
- Single expand mode
- Multiple expand mode

3. Run build to verify

### Task 3: Update STATE.md and ROADMAP.md

1. Update STATE.md:
   - Mark all phases complete
   - Add Phase 7 decisions
   - Update velocity metrics

2. Update ROADMAP.md:
   - Mark Phase 7 complete with date
   - Update progress table

## Verification

- [ ] Accordion expands/collapses on click
- [ ] Single mode: only one item open
- [ ] Multiple mode: multiple items open
- [ ] Disabled items cannot expand
- [ ] All Phase 7 examples in App.tsx
- [ ] Build passes

## Output

- `packages/react/src/components/Accordion/Accordion.tsx`
- `packages/react/src/components/Accordion/accordion.module.css`
- `packages/react/src/components/Accordion/index.tsx`
- Updated App.tsx with Phase 7 examples
- Updated STATE.md and ROADMAP.md
